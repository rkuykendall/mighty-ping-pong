import datetime

from django.db import migrations

historical = '''Mink,Blake,2018-08-27
Mike,Mink,2018-08-27
Mike,Blake,2018-08-27
Jordan,Wellins,2018-08-27
Mink,Jordan,2018-08-27
Jordan,Wellins,2018-08-27
Mike,Jordan,2018-08-27
Mike,Julian,2018-08-27
Ryan,Julian,2018-08-28
Mike,Wellins,2018-08-28
Mink,Blake,2018-08-28
Wellins,Jordan,2018-08-28
Mike,Julian,2018-08-28
Mike,Ryan,2018-08-28
Jordan,Tom,2018-08-28
Jordan,Wellins,2018-08-28
Julian,Blake,2018-08-28
Julian,Blake,2018-08-28
Julian,Ryan,2018-08-28
Mink,Jeff,2018-08-28
Ryan,Mink,2018-08-28
Ryan,Mike,2018-08-28
Julian,Bryce,2018-08-28
Tom,Bryce,2018-08-28
Jordan,Tom,2018-08-28
Mike,Jordan,2018-08-28
Mike,Ryan,2018-08-28
Blake,Wellins,2018-08-28
Mink,Blake,2018-08-28
Mink,Blake,2018-08-28
Mink,Julian,2018-08-28
Mike,Ryan,2018-08-28
Mink,Ryan,2018-08-28
Ryan,Jordan,2018-08-28
Julian,Ryan,2018-08-28
Mink,Blake,2018-08-28
Mink,Blake,2018-08-28
Mink,Julian,2018-08-28
Mink,Julian,2018-08-28
Blake,Julian,2018-08-28
Ryan,Tom,2018-08-29
Julian,Ryan,2018-08-29
Mike,Julian,2018-08-29
Tom,Madison,2018-08-29
Mike,Julian,2018-08-29
Jordan,Tom,2018-08-29
Wellins,Tom,2018-08-29
Mike,Mink,2018-08-29
Mike,Julian,2018-08-29
Ryan,Mink,2018-08-29
Ryan,Julian,2018-08-29
Ryan,Julian,2018-08-29
Ryan,Josh,2018-08-29
Mink,Blake,2018-08-29
Ryan,Mink,2018-08-29
Ryan,Julian,2018-08-29
Ryan,Mike,2018-08-29
Mike,Blake,2018-08-29
Jordan,Penelope,2018-08-29
Jeff,Josh,2018-08-29
Mink,Jordan,2018-08-29
Mink,Jeff,2018-08-29
Mink,Wellins,2018-08-29
Mink,Mike,2018-08-29
Mink,Mike,2018-08-29
Mike,Jeff,2018-08-29
Blake,Jeff,2018-08-29
Blake,Jeff,2018-08-29
Mink,Blake,2018-08-29
Mink,Blake,2018-08-29
Mike,Ryan,2018-08-30
Mike,Jordan,2018-08-30
Wellins,Jordan,2018-08-30
Jordan,Wellins,2018-08-30
Mike,Julian,2018-08-30
Julian,Ryan,2018-08-30
Jordan,Wellins,2018-08-30
Ryan,Mike,2018-08-30
Mike,Ryan,2018-08-30
Wellins,Bryce,2018-08-30
Mink,Blake,2018-08-30
Julian,Jordan,2018-08-30
Mike,Julian,2018-08-30
Madison,Bryce,2018-08-30
Madison,Bryce,2018-08-30
Wellins,Madison,2018-08-30
Mink,Blake,2018-08-30
Mink,Blake,2018-08-30
Ryan,Mink,2018-08-30
Ryan,Julian,2018-08-30
Ryan,Julian,2018-08-30
Ryan,Mike,2018-08-30
Ryan,Mink,2018-08-30
Mike,Mink,2018-08-30
Mink,Blake,2018-08-30
Blake,Mink,2018-08-30
Mink,Blake,2018-08-30
Ryan,Mink,2018-08-31
Wellins,Tom,2018-08-31
Jordan,Tom,2018-08-31
Tom,Jordan,2018-08-31
Jordan,Tom,2018-08-31
Madison,Tom,2018-08-31
Madison,Bryce,2018-08-31
Jordan,Madison,2018-08-31
Jordan,Tom,2018-08-31
Ryan,Jordan,2018-08-31
Mike,Ryan,2018-08-31
Mike,Wellins,2018-08-31
Ryan,Jordan,2018-08-31
Jordan,Penelope,2018-08-31
Jordan,Bryce,2018-08-31
Ryan,Jordan,2018-08-31
Wellins,Jordan,2018-08-31
Madison,Jordan,2018-08-31
Mink,Jeff,2018-08-31
Mink,Jeff,2018-08-31
Madison,Ryan,2018-08-31
Wellins,Jordan,2018-09-01
Jeff,Wellins,2018-09-01
Wellins,Jordan,2018-09-04
Julian,Mink,2018-09-04
Julian,Mink,2018-09-04
Penelope,Bryce,2018-09-04
Mike,Julian,2018-09-04
Mike,Mink,2018-09-04
Mike,Wellins,2018-09-04
Madison,Wellins,2018-09-04
Mike,Julian,2018-09-06
Mike,Julian,2018-09-06
Mike,Julian,2018-09-06
Mike,Jordan,2018-09-06
Julian,Mink,2018-09-06
Julian,Mink,2018-09-06
Wellins,Madison,2018-09-06
Jeff,Mink,2018-09-06
Julian,Mink,2018-09-06
Mink,Jeff,2018-09-06
Mink,Julian,2018-09-06
Mink,Julian,2018-09-06
Julian,Mink,2018-09-07
Julian,Mink,2018-09-07
Mike,Julian,2018-09-07
Mike,Julian,2018-09-07
Julian,Wellins,2018-09-07
Mike,Mink,2018-09-07
Mink,Wellins,2018-09-07
Mike,Jordan,2018-09-07
Mike,Wellins,2018-09-07
Mike,Wellins,2018-09-07
Wellins,Jordan,2018-09-07
Wellins,Jordan,2018-09-07
Mink,Madison,2018-09-08
Mink,Wellins,2018-09-08
Mink,Wellins,2018-09-08
Wellins,Jeff,2018-09-08
Jeff,Madison,2018-09-08
Jeff,Madison,2018-09-08
Wellins,Jeff,2018-09-08
Mike,Mink,2018-09-10
Julian,Mink,2018-09-10
Mink,Blake,2018-09-10
Mink,Blake,2018-09-10
Ryan,Julian,2018-09-10
Ryan,Julian,2018-09-10
Mike,Julian,2018-09-10
Mike,Ryan,2018-09-10
Tom,Bryce,2018-09-10
Tom,Wellins,2018-09-10
Tom,Wellins,2018-09-10
Penelope,Bryce,2018-09-10
Wellins,Tom,2018-09-10
Wellins,Jordan,2018-09-10
Ryan,Mink,2018-09-10
Ryan,Julian,2018-09-10
Ryan,Mink,2018-09-10
Ryan,Mike,2018-09-10
Mink,Blake,2018-09-11
Mink,Blake,2018-09-11
Mink,Blake,2018-09-11
Wellins,Jordan,2018-09-11
Ryan,Mink,2018-09-11
Wellins,Jordan,2018-09-11
Jordan,Wellins,2018-09-11
Mike,Ryan,2018-09-11
Mike,Ryan,2018-09-11
Ryan,Jordan,2018-09-11
Ryan,Mink,2018-09-11
Julian,Ryan,2018-09-11
Ryan,Mike,2018-09-11
Ryan,Mike,2018-09-11
Mike,Jordan,2018-09-11
Mike,Wellins,2018-09-11
Wellins,Jordan,2018-09-11
Mike,Blake,2018-09-11
Mink,Wellins,2018-09-11
Mink,Blake,2018-09-11
Mink,Blake,2018-09-11
Ryan,Mink,2018-09-12
Ryan,Mink,2018-09-12
Julian,Ryan,2018-09-12
Julian,Mike,2018-09-12
Julian,Mike,2018-09-12
Wellins,Tom,2018-09-13
Mink,Blake,2018-09-13
Ryan,Wellins,2018-09-13
Mink,Ryan,2018-09-13
Julian,Ryan,2018-09-13
Julian,Mike,2018-09-13
Julian,Mike,2018-09-13
Mike,Julian,2018-09-13
Ryan,Wellins,2018-09-13
Ryan,Blake,2018-09-13
Ryan,Mink,2018-09-13
Ryan,Mink,2018-09-13
Ryan,Mink,2018-09-13
Mink,Ryan,2018-09-14
Mike,Julian,2018-09-14
Mink,Blake,2018-09-14
Mink,Blake,2018-09-14
Blake,Wellins,2018-09-14
Blake,Wellins,2018-09-14
Wellins,Tom,2018-09-17
Mink,Blake,2018-09-17
Blake,Mink,2018-09-17
Julian,Ryan,2018-09-17
Julian,Ryan,2018-09-17
Ryan,Julian,2018-09-17
Ryan,Julian,2018-09-17
Blake,Ryan,2018-09-17
Mink,Blake,2018-09-17
Mink,Blake,2018-09-17
Mike,Blake,2018-09-17
Mink,Ryan,2018-09-17
Mink,Wellins,2018-09-17
Blake,Jordan,2018-09-18
Ryan,Blake,2018-09-18
Mink,Jordan,2018-09-18
Ryan,Julian,2018-09-18
Wellins,Blake,2018-09-18
Wellins,Jordan,2018-09-18
Ryan,Mike,2018-09-18
Mike,Ryan,2018-09-18
Ryan,Mike,2018-09-18
Mink,Wellins,2018-09-18
Mink,Blake,2018-09-18
Blake,Mink,2018-09-18
Blake,Wellins,2018-09-18
Mike,Wellins,2018-09-18
Mike,Blake,2018-09-18
Mike,Jack,2018-09-18
Blake,Jack,2018-09-18
Mink,Madison,2018-09-18
Mink,Mike,2018-09-18
Mink,Mike,2018-09-18
Mink,Blake,2018-09-18
Mink,Julian,2018-09-18
Wellins,Madison,2018-09-18
Mink,Wellins,2018-09-19
Blake,Wellins,2018-09-19
Blake,Wellins,2018-09-19
Mike,Julian,2018-09-19
Mike,Ryan,2018-09-19
Ryan,Julian,2018-09-19
Ryan,Julian,2018-09-19
Ryan,Mink,2018-09-19
Jordan,Wellins,2018-09-19
Ryan,Jordan,2018-09-19
Blake,Ryan,2018-09-19
Ryan,Jordan,2018-09-19
Ryan,Wellins,2018-09-19
Blake,Ryan,2018-09-19
Mink,Palermo,2018-09-19
Blake,Palermo,2018-09-19
Mike,Jordan,2018-09-19
Mike,Mink,2018-09-19
Mike,Blake,2018-09-19
Jordan,Madison,2018-09-20
Jordan,Tom,2018-09-20
Mink,Blake,2018-09-20
Mink,Ryan,2018-09-20
Wellins,Jordan,2018-09-20
Mink,Blake,2018-09-20
Mink,Blake,2018-09-20
Blake,Tom,2018-09-20
Blake,Wellins,2018-09-20
Ryan,Mink,2018-09-20
Tom,Madison,2018-09-20
Madison,Tom,2018-09-20
Mike,Ryan,2018-09-20
Blake,Ryan,2018-09-20
Wellins,Jordan,2018-09-20
Wellins,Tom,2018-09-20
Mink,Jeff,2018-09-20
Mink,Jeff,2018-09-20
Tom,Wellins,2018-09-20
Julian,Ryan,2018-09-20
Julian,Ryan,2018-09-20
Julian,Mink,2018-09-20
Mink,Jeff,2018-09-20
Mink,Jeff,2018-09-20
Mink,Julian,2018-09-20
Mink,Wellins,2018-09-20
Mink,Blake,2018-09-20
Mink,Wellins,2018-09-20
Mink,Jeff,2018-09-20
Mink,Blake,2018-09-21
Blake,Mink,2018-09-21
Wellins,Madison,2018-09-21
Mike,Blake,2018-09-21
Mike,Ryan,2018-09-21
Ryan,Julian,2018-09-21
Ryan,Blake,2018-09-21
Blake,Ryan,2018-09-21
Blake,Mink,2018-09-21
Mink,Blake,2018-09-21
Mink,Julian,2018-09-21
Mink,Mike,2018-09-21
Julian,Mink,2018-09-21
Madison,Wellins,2018-09-21
Blake,Madison,2018-09-21
Blake,Wellins,2018-09-21
Blake,Palermo,2018-09-21
Mike,Blake,2018-09-22
Wellins,Madison,2018-09-22
Jordan,Tom,2018-09-24
Jordan,Wellins,2018-09-24
Jordan,Tom,2018-09-24
Mike,Julian,2018-09-24
Mike,Ryan,2018-09-24
Mink,Jeff,2018-09-24
Ryan,Mink,2018-09-24
Ryan,Julian,2018-09-24
Jeff,Mink,2018-09-24
Mike,Ryan,2018-09-24
Mike,Mink,2018-09-24
Wellins,Jordan,2018-09-24
Ryan,Julian,2018-09-25
Wellins,Tom,2018-09-25
Tom,Jordan,2018-09-25
Tom,Wellins,2018-09-25
Ryan,Mike,2018-09-25
Ryan,Blake,2018-09-25
Tom,Bryce,2018-09-25
Mink,Jordan,2018-09-25
Mink,Wellins,2018-09-25
Mike,Mink,2018-09-25
Mink,Mike,2018-09-25
Mike,Mink,2018-09-25
Mike,Blake,2018-09-25
Mike,Blake,2018-09-25
Mike,Julian,2018-09-25
Julian,Blake,2018-09-25
Julian,Blake,2018-09-25
Julian,Blake,2018-09-25
Blake,Wellins,2018-09-25
Mink,Julian,2018-09-26
Mink,Jordan,2018-09-26
Blake,Mink,2018-09-26
Ryan,Blake,2018-09-26
Mike,Wellins,2018-09-26
Mike,Ryan,2018-09-26
Mink,Mike,2018-09-26
Mike,Mink,2018-09-26
Mink,Mike,2018-09-26
Mink,Blake,2018-09-26
Wellins,Blake,2018-09-26
Blake,Jack,2018-09-26
Jack,Blake,2018-09-26
Julian,Mink,2018-09-26
Mink,Julian,2018-09-26
Mink,Julian,2018-09-26
Blake,Wellins,2018-09-27
Jordan,Tom,2018-09-27
Mink,Julian,2018-09-27
Mink,Blake,2018-09-27
Blake,Mink,2018-09-27
Jordan,Wellins,2018-09-27
Jordan,Tom,2018-09-27
Mike,Mink,2018-09-27
Mike,Mink,2018-09-27
Mink,Blake,2018-09-27
Mink,Blake,2018-09-27
Mike,Blake,2018-09-27
Mike,Blake,2018-09-27
Wellins,Madison,2018-09-27
Wellins,Jordan,2018-09-27
Wellins,Jordan,2018-09-27
Wellins,Tom,2018-09-27
Jordan,Wellins,2018-09-27
Mink,Blake,2018-09-27
Mink,Blake,2018-09-27
Blake,Mink,2018-09-27
Ryan,Wellins,2018-09-28
Mink,Blake,2018-09-28
Mink,Ryan,2018-09-28
Mink,Blake,2018-09-28
Ryan,Mink,2018-09-28
Mink,Jordan,2018-09-28
Mink,Ryan,2018-09-28
Julian,Blake,2018-09-28
Julian,Mink,2018-09-28
Mink,Julian,2018-09-28
Julian,Mink,2018-09-28
Mink,Julian,2018-09-28
Mink,Blake,2018-10-01
Mink,Ryan,2018-10-01
Mink,Julian,2018-10-01
Mink,Madison,2018-10-02
Mink,Ryan,2018-10-02'''


def add_historical_data(apps, schema_editor):
    Group = apps.get_model('auth', 'Group')
    Match = apps.get_model('matches', 'Match')
    Player = apps.get_model('base', 'Player')

    players_group = Group(name='Players Group')
    players_group.save()

    match_strings = [s.split(',') for s in historical.splitlines()]
    user_strings = list(set([m[0] for m in match_strings] + [m[1] for m in match_strings]))

    players = {}

    for user_string in user_strings:
        player = Player(
            first_name=user_string,
            is_staff=True,
            is_superuser=False,
            username=user_string.lower(),
        )
        player.save()
        players_group.user_set.add(player)
        players[user_string] = player

    for match_string in match_strings:
        winner = players[match_string[0]]
        loser = players[match_string[1]]
        date = datetime.datetime.strptime(match_string[2], "%Y-%m-%d").date()
        match = Match(winner_id=winner.id, loser_id=loser.id, created_at=date, modified_at=date)
        match.save()


class Migration(migrations.Migration):

    dependencies = [
        ('matches', '0001_initial'),
    ]

    operations = [
        migrations.RunPython(add_historical_data)
    ]
